---
title: 微服务（上）
date: 2019-03-11 22:00:00
tags:
---

# 微服务(Micro services architecture)

MSA是一种服务架构，旨在降低面对快速迭代需求时的开发、测试、部署和运维难度，提高服务集群的健壮性。

## 演进

SOA

解决的问题（相对面向SDK的架构而言）

* 降低代码级别的耦合
  * 提高迭代速度
    
    传统面向SDK的架构，由于公用组件的的一次微小改动，将迫使整个服务进行一次大规模的回归测试，这极大的阻碍了迭代的速度。
* 增加整体服务的健壮性
  
  部分服务不可用，不会导致整个服务不可用。传统面向组件的架构，由于公用组件的的一个Bug，可能导致整个服务不可用。
  
MSA在SOA的基础之上，对服务进行更细粒度的拆分。

## 微服务

### 特性

* 小，只干一件事情
* 独立部署
* 轻量的进程间通信（RPC、Restful）

### 拆分原则

* 横向按照业务拆分
* 纵向按照模块进行拆分，沉淀出相对稳定的原子服务

### 开发原则

* 面向接口开发

  * 接口先行，语言中立
  * 提供在线的api文档（如swagger UI）
  * 注意接口的向前兼容
  * 接口更改即时通知
  
* Mock服务
  
  面向接口开发，旨在将消息生产者与消费者解耦。但不可避免的会遇到接口依赖方进度落后。此时，需要Mock服务帮忙提供Debug数据，以使双方能够并行开发。

  如图所示：

  ![](https://ss0.bdstatic.com/6Ox1bjeh1BF3odCf/it/u=3689925622,4184203608&fm=196&app=62&f=JPEG?w=600&h=249&s=42D6549A9C60F513147DADD9030010B1)
  
### 部署原则

* 独立部署和生命周期管理、基础设施自动化。需要有一套类似于CI/CD的流水线来做基础设施自动化。
* 运行的容器
  
  * 物理机
  * PaaS平台
  * Docker

  采用Docker部署，有几大优势：
  * 一致的环境（线上线下一致）
  * 避免对特定laas设施的依赖
  * 降低运维负担
  
待续
